# Tests Are The New Moat

Daniel Saewitz (2026-02-24):
<https://saewitz.com/tests-are-the-new-moat>

AI가 코드를 복제하는 시대에
테스트가 오픈소스의 새로운 해자(moat)가 된다는 주장.

## 요약

오픈소스 프로젝트는 점진적으로 성장한다.
가볍게 시작해서 채택을 얻고,
하위 호환성을 유지하면서 거대한 배가 된다.
이 배는 자체 관성 속에서 방향 전환이 어렵다.

역사적으로 이 문제의 해법은 두 가지였다:
포크(fork)와 전면 재작성(total rewrite).
S3 호환 API나 Kafka 호환 Redpanda가 그 예다.

AI가 이 역학을 근본적으로 바꾼다.

### 인센티브의 충돌

순수 FOSS는 포크와 재작성이 괜찮다.
그러나 상업적 오픈소스(commercial OSS)는
이타주의와 사업 인센티브 사이에서 긴장한다.

Saewitz의 관찰:

> 오픈소스는 오랫동안 순수한 이타주의를
> 표방해왔다. 그러나 규모가 커지면
> 그 전제가 무너지는 지점이 많다.
> 기업은 오픈소스에 기여하기도 했지만,
> 환원 없이 가치를 추출하기도 했다.

### 테스트의 부상

좋은 문서, 강한 계약, 잘 설계된 인터페이스,
포괄적 테스트 스위트 —— 이것들은 사용자가
플랫폼을 신뢰하게 만드는 요소였다.

그런데 이 모든 것이 경쟁 기업이
AI를 이용해 재구현하기 쉽게 만든다.
하위 호환성도, 관성의 배도 필요 없다.
AI에게 문서를 읽히고, 테스트를 가져오고,
기반을 바꾸면 된다.

> "Those tests are far more valuable than
> loose words on a docs page."
>
> 테스트는 문서 페이지의 느슨한 말보다
> 훨씬 가치 있다.

### Cloudflare와 Vercel

Cloudflare 엔지니어 한 명이 AI(Claude)를 사용해
1주일 만에 Next.js API 표면적의 94%를
재구현했다(vinext). 토큰 비용 약 $1,100.

이것이 가능했던 이유:

- Vercel이 수년간 공들인 문서, 계약,
  테스트 스위트가 AI에게 완벽한 명세가 되었다
- 기존 사용자가 없으니 하위 호환성이 불필요했다
- Turbopack 대신 더 성숙한 Vite 위에 구축했다

1,700개의 Vitest 테스트와 380개의 Playwright
테스트를 통과한다.
미국 정부 웹사이트(cio.gov)에 이미 배포되었다.
"완성"은 아니지만 장난감도 아니다.

### Δ Change: SQLite의 선견지명

> "세상이 변할 때, 다른 모두보다
> 조금 더 멀리 본 그룹이 있다.
> 이 경우, SQLite다."

SQLite는 코어를 완전히 오픈소스로 공개하면서도
엄격한 테스트 스위트의 상당 부분을
비공개로 유지한다.

- 코어 소스: 약 155,800줄
- 테스트 코드: 약 9,200만 줄 (코어의 592배)
- TH3: 100% 브랜치 커버리지,
  릴리스 전 약 2.48억 테스트 인스턴스 실행
- dbsqlfuzz: 16코어에서 상시 가동,
  하루 약 5억 케이스 점검

> "사용자가 그것을 빚진 것은 아니다(users are
> not owed it). 그것이 해자를 구축하는 최선의
> 방법이라면, 그것은 그들의 선택이다."

### tldraw의 후속 움직임

2026-02-25 추가:
tldraw가 전체 테스트 스위트를 공개 저장소에서
비공개 저장소로 이전했다.
<https://github.com/tldraw/tldraw/issues/8082>

## 분석

### 해자의 역전 현상

| 전통적 해자         | AI 시대 효과               |
|---------------------|----------------------------|
| 방대한 코드베이스   | AI가 빠르게 재구현         |
| 복잡한 아키텍처     | AI에게 복잡성은 장벽 아님  |
| 상세한 문서         | AI의 완벽한 입력이 됨      |
| 명확한 API 계약     | AI의 정확한 명세가 됨      |
| 포괄적 테스트       | AI의 검증 기준이 됨        |

과거에 경쟁력이었던 것이
이제 복제를 돕는 도구가 된다.
유일하게 해자로 남는 것은
"공개하지 않은 테스트"다.

### "거대한 배"의 비유와 재구현 비용

Saewitz는 오픈소스 프로젝트를 "배"에 비유한다.
프로젝트가 성장할수록 배가 커지고,
자체 관성(velocity) 때문에 방향 전환이 어렵다.

전통적으로 이 관성 자체가 해자였다:
재구현 비용이 너무 크니 아무도 시도하지 않았다.

Vercel은 이 관성과 싸우며 내부를 현대화하려 했다:
Webpack을 Turbopack으로 재구현,
자체 MDX 파서 구축,
복잡한 레이아웃 패러다임 혁신,
Partial Pre-rendering 발명.

그런데 Cloudflare는 이 모든 짐 없이
깨끗한 슬레이트에서 시작할 수 있었다.
AI가 재구현 비용을 극적으로 낮추면서,
"관성의 배"는 해자가 아니라 약점이 된다.

### 오픈소스의 사회 계약 재편

오픈소스는 암묵적 사회 계약 위에 성립했다:
"공개하되, 재구현의 비용이 크니 공존한다."

AI가 재구현 비용을 거의 0으로 만들면
이 계약이 무너진다.

Saewitz는 이분법을 거부한다.
"순수 이타주의 vs 비공개"가 아니라,
"어떤 인센티브를 어떻게 균형 잡을 것인가"의
문제로 본다.

장기적 관점이 대체로 사업에도 이롭지만,
그 긴장은 항상 존재한다(ever-present).

### 문서화의 딜레마

좋은 문서화는 사용자 경험을 위해 필수적이다.
그런데 이제 그 문서가 경쟁자(와 AI)에게
최고의 복제 가이드가 된다.

> AI 세상에서, 당신이 일을 더 잘 문서화하고
> 더 강한 계약을 정의할수록,
> 누군가가 당신의 일을 복제하기가 더 쉬워진다.

이것은 해결 불가능한 딜레마가 아니라
"무엇을 공개하고 무엇을 유보할 것인가"에 대한
전략적 판단의 문제다.

## 인사이트

### 테스트의 이중적 가치

테스트는 두 가지 상반된 역할을 동시에 수행한다:

1. **품질 보증 도구**: 소프트웨어가 올바르게
   작동함을 증명한다
2. **지적 자산**: 수년간의 엣지 케이스 발견,
   버그 수정, 도메인 지식이 응축된 산물이다

코드는 "무엇을 하는가"를 담는다.
테스트는 "무엇이 잘못될 수 있는가"를 담는다.
후자가 더 축적하기 어렵고, 더 가치 있다.

SQLite의 9,200만 줄은 코딩 능력의 산물이 아니라
수십 년간 실패를 관찰하고 기록한 지식의 산물이다.

### 포크·재작성의 역사가 예고한 것

S3 호환 API, Redpanda(Kafka 호환 재작성)
같은 사례는 이미 있었다.
차이는 과거에는 "팀 단위, 수개월"이 필요했고
지금은 "1인, 1주일, $1,100"이면 된다는 것이다.

재작성의 진입 장벽이 무너지면서,
이제 모든 잘 문서화된 오픈소스 프로젝트가
잠재적 재작성 대상이 된다.

### Cloudflare 사례의 한계 인식

vinext가 Next.js API의 94%를 구현했다고 하지만,
나머지 6%와 엣지 케이스의 장기 안정성은
다른 문제다.

Saewitz도 "hardly complete"라고 인정한다.
그러나 "not just a toy either"라는 점이 핵심이다.

프로덕션 수준의 신뢰성은 단순 API 호환성을
넘어선다:

- 수천 개 프로젝트에서 보고된 엣지 케이스 처리
- 다양한 환경에서의 검증
- 성능 회귀를 잡아내는 벤치마크 테스트
- 보안 취약점 발견과 패치의 이력

이것이 바로 공개 테스트만으로 복제할 수 없는
"숨겨진 빙산"이다.

### TDD와의 연결: 개인에서 생태계까지

[AI 시대에 TDD가 더 강력해진 이유](
../ai/tdd-in-ai-era.md)에서 분석한 것처럼,
AI 시대에 인간의 핵심 역할은
"테스트를 작성하는 것"으로 수렴한다.

이 글은 그 관찰을 기업 전략 수준으로 확장한다:

| 수준       | 테스트의 역할                  |
|------------|--------------------------------|
| 개인       | AI에게 정확한 명세 제공        |
| 팀         | 코드베이스의 신뢰성 유지       |
| 기업       | 경쟁 우위(해자) 확보           |
| 생태계     | 오픈소스 지속가능성의 핵심     |

### 새로운 오픈소스 모델의 예고

SQLite는 선구자였고, tldraw가 뒤따랐다.
앞으로 예상되는 변화:

- "코드 오픈, 테스트 클로즈드" 모델의 확산
- 테스트 스위트를 유료 구독으로 제공하는 모델
- 핵심 테스트와 공개 테스트의 이중 구조화
- CI/CD 파이프라인에서 비공개 테스트를
  경쟁력으로 활용하는 전략

### 반론: 테스트 해자의 한계

Pekka Enberg(Turso/Limbo)의 반론도 주목할 만하다.
9,200만 줄의 비공개 테스트가 장기적으로
최선의 전략인지 의문을 제기한다.

대안적 검증 방법:

- 결정론적 시뮬레이션 테스팅(Antithesis)
- 퍼즈 테스팅(Fuzz Testing)
- 호환성 기반 테스팅

테스트를 "쌓는 것"이 해자가 아니라,
"검증 방법론의 혁신"이 진짜 해자일 수 있다.

또한 Lobsters 토론에서 지적된 것처럼,
SQLite 테스트 스위트의 상당 부분은
실제로 퍼블릭 도메인이다.
비공개 테스트는 주로 새 하드웨어에서의
안정성 검증을 위한 스트레스 테스트다.

### "보이지 않는 비용"에서 "보이지 않는 자산"으로

전통적으로 테스트는 비용으로 인식되었다.
작성 시간, 유지보수 부담, CI 실행 시간.

이 글의 핵심 전환:
테스트는 비용이 아니라 자산이다.
그것도 시간이 지날수록 가치가 증가하는 자산이다.

AI가 코드 작성 비용을 0에 수렴시킬수록,
테스트에 축적된 도메인 지식의 상대적 가치가
기하급수적으로 올라간다.

이것은 Kent Beck의 "복리 게임"과 정확히 일치한다.
테스트는 미래 옵션(futures)이다.

---

## 결론

AI가 코드 복제 비용을 극적으로 낮추면서,
소프트웨어 프로젝트의 해자가 재정의되고 있다.

문서, API 계약, 코드 자체는
더 이상 해자가 아니라 복제의 촉진제가 된다.

남는 것은 테스트다.
수년간의 실패 경험, 엣지 케이스 지식,
도메인 이해가 응축된 테스트만이
AI로도 쉽게 복제할 수 없는 자산이다.

개인 수준에서 팀, 기업, 생태계 수준까지
테스트의 전략적 가치가 재평가되는 시점이다.

---

## 관련 문서

- [AI 시대에 TDD가 더 강력해진 이유](
  ../ai/tdd-in-ai-era.md)
- [Test Pyramid](./test-pyramid.md)
- [Earn and Learn](../ai/earn-and-learn.md)

## 참고

- [Tests Are The New Moat - Daniel Saewitz](
  https://saewitz.com/tests-are-the-new-moat)
- [How we rebuilt Next.js with AI in one week
  - Cloudflare Blog](
  https://blog.cloudflare.com/vinext/)
- [The Pulse #164 - Pragmatic Engineer](
  https://newsletter.pragmaticengineer.com/p/the-pulse-164-nextjs)
- [How SQLite Is Tested](
  https://sqlite.org/testing.html)
- [tldraw test suite 이전](
  https://github.com/tldraw/tldraw/issues/8082)
- [Lobsters Discussion](
  https://lobste.rs/s/8utm05/tests_are_new_moat)
