# PentAGI

LLM 기반 에이전트가 침투 테스트 절차를 단계적으로
수행하도록 설계된 자율형 보안 테스트 플랫폼.

단일 취약점 스캐너보다, 멀티스텝 공격 시나리오를 자동으로
조합하는 흐름이 시장에서 빠르게 관심을 얻고 있다.

보안팀의 인력 병목(반복 정찰, 초기 검증, 리포트 초안) 구간을
자동화할 수 있는 후보로 평가된다.

<https://pentagi.com/>

<https://github.com/vxcontrol/pentagi>

## 자율형 레드팀 도구를 분석할 때 유효한 공통 프레임

### 1. Planner-Executor 루프

에이전트형 보안 도구의 핵심은 다음 루프다.

```text
목표 정의 -> 정찰/정보수집 -> 가설 수립 -> 액션 실행
-> 결과 관측 -> 계획 갱신 -> 종료/보고
```

체크 포인트:

- Planner가 "무엇을 할지"를 결정하는가
- Executor가 "어떻게 실행할지"를 담당하는가
- 관측 결과가 다음 액션에 실제 반영되는가
- 무한 루프 방지(스텝 제한, 비용 제한, 시간 제한)가 있는가

### 2. Tool Adapter 계층

실무 침투 테스트 자동화는 결국 외부 도구 호출 품질이 좌우한다.

- Nmap, HTTP 클라이언트, 취약점 스캐너, 브루트포스 도구 등을
  어떤 인터페이스로 감쌌는지
- 도구 표준 출력/오류를 구조화된 이벤트로 변환하는지
- 재시도, 타임아웃, 실패 격리 정책이 있는지

### 3. Memory / State 관리

에이전트 품질은 "이전 관측을 얼마나 정확히 유지하는지"에 크게
영향받는다.

- 타깃 자산 목록, 열린 포트, 서비스 버전, 취약점 가설,
  성공/실패 이력 등을 상태로 유지하는지
- 중복 스캔을 줄이는 캐시 전략이 있는지
- 세션 재개(resume) 시 상태 복원이 가능한지

### 4. Guardrail / Policy 엔진

보안 자동화 도구에서 가장 중요한 영역이다.

- 허용된 타깃 범위(CIDR, 도메인, URL 패턴) 강제 여부
- 파괴적 액션 차단 정책(예: 데이터 삭제, 서비스 중단 유발)
- 승인 워크플로(수동 승인, 단계 승인, 고위험 액션 이중 승인)
- 감사 로그(누가, 언제, 어떤 명령을 실행했는지) 제공 여부

### 5. Reporting 파이프라인

자동화는 "실행"보다 "재현 가능한 보고"에서 가치가 커진다.

- 발견 사항을 CVE/CWE 기준으로 정리하는지
- 근거(요청/응답, 명령 결과, 스크린샷)를 연결하는지
- 재현 절차와 완화 방안을 분리해 제시하는지

## 실무 도입 인사이트

### 1. SIEM/SOAR와의 연결이 성패를 가른다

단독 도구로 끝나면 "재미있는 데모"가 되기 쉽다.
탐지(Detection), 대응(Response), 티켓(Jira/Linear),
증적 저장(S3/Blob)과 연결해야 운영 가치가 생긴다.

### 2. CI/CD 보안 게이트로 바로 넣지 말고

초기에는 스테이징 또는 샌드박스에서만 돌려야 한다.
오탐/과탐, 테스트 시간 증가, 서비스 영향도를 먼저 측정한 뒤
점진적으로 범위를 넓히는 편이 안전하다.

### 3. "완전 자율"보다 "제한된 자율"이 현실적이다

현업에서는 다음 모델이 보통 더 잘 작동한다.

- 저위험 단계: 자동 실행
- 중위험 단계: 보안 담당자 승인 후 실행
- 고위험 단계: 팀 리드 승인 + 시간/범위 제한

### 4. 평가 지표를 먼저 설계해야 한다

도입 전에 KPI를 정의해 두지 않으면 효과 검증이 어렵다.

- 평균 탐지 시간(MTTD) 단축률
- 재현 가능한 리포트 비율
- 오탐률/미탐률 변화
- 테스트 1회당 비용(토큰 + 인프라 + 인력)

## 리스크와 주의사항

- 법적 범위를 벗어난 스캔은 즉시 컴플라이언스 이슈가 된다.
- LLM 환각으로 잘못된 액션을 제안할 수 있다.
- 프롬프트 인젝션/툴 인젝션에 취약할 수 있다.
- 고권한 실행 환경에서는 내부 시스템에 2차 피해를 줄 수 있다.

권장 최소 통제:

1. 명시적 스코프 allowlist
2. 네트워크 격리된 실행 런너
3. 액션별 레이트 리밋/쿼터
4. 중앙 감사 로그 + 변경 불가 보관
5. 비상 중지(kill switch)

## PoC 체크리스트

1. 2~3개 내부 서비스만 대상으로 범위 제한
2. 읽기 전용 정찰 시나리오부터 시작
3. 리포트 품질(재현성, 근거 링크) 먼저 평가
4. 승인 정책/로그 정책 고정 후 공격 시나리오 확대
5. 분기 단위로 도구/모델 성능 재평가
