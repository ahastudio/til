# Red/Green TDD

Simon Willison의 Agentic Engineering Patterns 시리즈 #2-1:
<https://simonwillison.net/guides/agentic-engineering-patterns/red-green-tdd/>

"Use red/green TDD." 이 네 단어짜리 프롬프트가 코딩
에이전트의 결과물을 극적으로 개선한다. 두 번째 패턴은
**테스트 우선 개발(test-first development)이 코딩 에이전트와
만났을 때 왜 완벽한 조합이 되는지**를 다룬다.

## TDD란 무엇인가

TDD(Test Driven Development)는 작성하는 모든 코드에
자동화된 테스트를 동반하는 프로그래밍 스타일이다.

가장 엄격한 형태는 테스트 우선 개발이다:

1. **테스트를 먼저 작성한다.**
2. **테스트가 실패함을 확인한다.** (Red)
3. **테스트를 통과시키는 구현을 작성한다.** (Green)

## 코딩 에이전트와의 궁합

코딩 에이전트의 대표적 위험 두 가지:

1. **동작하지 않는 코드**를 생성한다.
2. **불필요한 코드**를 만들고 아무도 쓰지 않는다.

테스트 우선 개발은 이 두 가지를 동시에 방어한다.
테스트가 구현의 정확성을 검증하고, 테스트에 정의된
것만 구현하도록 범위를 제한하기 때문이다.

프로젝트가 커질수록 새로운 변경이 기존 기능을 깨뜨릴
확률도 함께 높아진다. 포괄적인 테스트 스위트는 이를
방지하는 가장 효과적인 수단이다.

## 왜 "Red"가 중요한가

테스트를 작성한 뒤 **실패를 확인하는 단계를 건너뛰면**
이미 통과하는 테스트를 만들 위험이 있다. 그런 테스트는
새 구현을 실제로 검증하지 못한다.

"Red/Green"의 의미:

- **Red:** 테스트가 실패하는 것을 지켜본다.
- **Green:** 구현 후 테스트가 통과함을 확인한다.

Red 단계가 없으면 테스트의 존재 자체가 거짓 안전감을
줄 뿐이다.

## 네 단어 프롬프트의 힘

모든 좋은 모델은 "red/green TDD"를 다음의 축약으로
이해한다:

> TDD를 사용하라. 테스트를 먼저 작성하고, 테스트가
> 실패하는 것을 확인한 뒤, 테스트를 통과시키는
> 변경을 구현하라.

이것이 프롬프트 엔지니어링으로서의 패턴이다. 모델에
이미 내장된 엔지니어링 규율을 네 단어로 활성화한다.

## 예시 프롬프트

```
Build a Python function to extract headers
from a markdown string. Use red/green TDD.
```

Willison의 전형적인 Python 세션 프롬프트:

```
Run the existing tests with "uv run pytest".
Build using red/green TDD.
```

테스트 실행 방법을 알려주는 것 자체가 "이 프로젝트에서
테스트는 중요하다"는 신호로 작동한다. 에이전트는 기존
테스트를 읽은 뒤 자체 테스트를 작성하므로, 좋은 패턴의
기존 테스트가 있으면 에이전트도 좋은 테스트를 작성할
가능성이 높아진다.

## 요약

| 구분               | 효과                              |
| ------------------ | --------------------------------- |
| Red 단계           | 테스트가 구현을 실제로 검증함     |
| Green 단계         | 코드가 동작함을 확인              |
| 범위 제한          | 불필요한 코드 생성 방지           |
| 리그레션 방지      | 미래의 변경으로부터 기존 기능 보호 |
| 프롬프트 효율      | 네 단어로 전체 워크플로 활성화    |

## 인사이트

### TDD 회의론자의 전향

Willison 본인이 커리어 전체에 걸쳐 테스트 우선 개발에
회의적이었다고 고백한다. "테스트 포함 개발(tests included
development)"을 선호했다. 하지만 코딩 에이전트 시대에
접어들며 테스트 우선으로 전향했다. 에이전트가 **필요한
코드만 작성하도록 강제**하는 가장 효과적인 수단이기
때문이다. 도구의 변화가 방법론에 대한 판단까지 바꾼
사례다.

### 프롬프트 엔지니어링으로서의 개발 방법론

"Red/green TDD"의 진짜 혁신은 개발 방법론을 **프롬프트
엔지니어링 기법**으로 재정의한 것이다. 모델에 이미
내장된 지식을 짧은 키워드로 활성화하는 접근법은,
앞으로 다른 개발 방법론(페어 프로그래밍, 코드 리뷰 등)
에도 동일하게 적용할 수 있다.

### Red 단계의 과소평가

많은 개발자가 TDD를 안다고 하면서 Red 단계를 생략한다.
사람에게도 중요하지만 에이전트에게는 더더욱 중요하다.
에이전트는 테스트와 구현을 동시에 생성할 수 있기 때문에,
이미 통과하는 무의미한 테스트를 만들 위험이 사람보다
훨씬 높다. Red 단계는 이 위험에 대한 유일한 안전장치다.

### 시리즈 1편과의 연결

[첫 번째 패턴](./agentic-engineering-patterns-01-code-is-cheap.md)
에서 "코드 작성은 거의 공짜"라고 했다. 공짜인 코드가
검증 없이 양산되면 기술 부채가 된다. Red/Green TDD는
"공짜 코드"의 품질을 보장하는 안전장치다. 두 패턴은
**문제 제기와 해결책**의 쌍으로 읽어야 한다.

### CLAUDE.md에 바로 적용하기

이 패턴의 실용적 가치는 즉시 적용 가능하다는 점이다.
프로젝트의 CLAUDE.md(또는 시스템 프롬프트)에 다음
한 줄을 추가하는 것만으로 효과를 볼 수 있다:

```
Build using red/green TDD.
```

## 관련 문서

- [Agentic Engineering Patterns #1: 코드 작성 비용은
  이제 거의 공짜다](./agentic-engineering-patterns-01-code-is-cheap.md)
- [TDD in AI Era](./tdd-in-ai-era.md)
- [Spec-Driven Development](./spec-driven-development.md)
- [AI Coding Agent Guidelines](./ai-coding-agent-guidelines.md)
