# Ralph Loop Setup

<https://x.com/d4m1n/status/2026032801322356903>

AI 에이전트를 장시간 자율 실행시키는 워크플로우.
4개 프로젝트를 이 방식으로 출시했고,
최장 37시간 연속 실행으로 2,000줄 요구사항에서
250개 작업을 완료했다고 한다.

## 핵심 구조

Docker 샌드박스 안에서 Claude Code(또는 다른
에이전틱 CLI)가 반복 루프를 돈다.

```
.agent/
├── PROMPT.md      # 반복 실행 지침
├── SUMMARY.md     # 프로젝트 요약 (컨텍스트)
├── STEERING.md    # 실행 중 방향 전환용
├── tasks.json     # 작업 목록
├── tasks/         # 개별 작업 스펙
├── prd/           # 제품 요구사항 문서
├── logs/          # 진행 추적
├── history/       # 반복 출력 기록
└── skills/        # 재사용 가능한 에이전트 스킬
```

### 실행 흐름

1. 에이전트가 작업 목록에서 최우선 작업을 선택
2. 구현
3. 테스트 실행으로 검증
4. 커밋
5. 종료 → 다음 반복은 새 컨텍스트로 시작

## 왜 작동하는가

**컨텍스트 윈도우 고갈 회피.**
대부분의 AI 코딩 세션은 컨텍스트가 차면 죽는다.
모델이 이전 지시를 잊고 출력 품질이 떨어진다.

Ralph Loop은 이걸 구조적으로 해결한다.
매 반복마다 새 컨텍스트로 시작하고,
상태는 텍스트 파일과 git 커밋에 저장한다.
컨텍스트 윈도우가 아니라 파일 시스템이 메모리다.

## 잘 되는 것 vs 안 되는 것

| 강점                     | 약점                     |
| ------------------------ | ------------------------ |
| 프로토타이핑, MVP        | 픽셀 퍼펙트 디자인       |
| E2E/단위 테스트 자동화   | 전례 없는 신규 아키텍처  |
| 프레임워크 마이그레이션  | 보안 크리티컬 코드       |
| 반복 작업 (리팩터링 등)  |                          |

## 실전 팁

- **테스트 필수 설치.** Playwright + Vitest.
  테스트 없으면 에이전트가 검증 없이 진행한다.
- **API 키는 미리 준비.** `.env`에 넣어두지 않으면
  통합 검증을 건너뛴다.
- **외부 문서는 마크다운으로 저장 후 참조.**
  에이전트가 추측하지 않게 `@docs/FILE.md`로 지정.
- **STEERING.md로 실행 중 개입.**
  크리티컬 버그 발견 시 여기에 쓰면 다음 반복에서
  우선 처리한다.
- **작게 시작 후 스케일업.** `-n 2` → `-n 10` →
  `-n 30` 순서로 신뢰도를 확인하며 늘린다.
- **리뷰를 건너뛰지 말 것.** 생성된 작업 스펙을
  반드시 검토. 잘못된 스펙 수정이 10개 커밋
  되돌리기보다 싸다.

## 분석

### File-based Planning과의 관계

[File-based Planning Workflow](./file-based-planning-workflow.md)의
실전 확장판이다. 둘 다 "컨텍스트 윈도우 대신
파일 시스템을 메모리로 쓴다"는 동일한 원리.
차이점은 Ralph Loop이 Docker 샌드박스 + 자동화된
반복 실행 + PRD 생성 스킬까지 패키징했다는 것.

### 역할 전환이 본질

트윗의 가장 중요한 문장:

> Your role changes. You stop being the one who
> writes every line and start being the one who
> plans, delegates, and reviews.

2026년에 가장 중요한 스킬은 코드를 빨리 치는 게
아니라 **원하는 것을 명확하게 기술하는 것**이다.
UI 스펙, 흐름, 제약조건, 통합 요건.
루프는 도구일 뿐이고, 진짜 일은 요구사항과
통과 기준을 정확히 정의하는 것이다.

### 구조적 교훈

1. **상태를 컨텍스트 밖으로 빼라.**
   컨텍스트 윈도우는 휘발성이다.
   영속적 상태는 파일과 커밋에 둬야 한다.
2. **검증 없는 자동화는 위험하다.**
   테스트가 자기 검증(self-verification) 역할.
   없으면 에이전트가 틀린 채로 계속 달린다.
3. **개입 채널을 열어둬라.**
   STEERING.md는 비동기 커뮤니케이션 채널.
   완전 자율이 아니라 "감독된 자율"이 현실적.
4. **실패 복구를 설계하라.**
   `git revert` → 테스트 실패 → 재시도.
   롤백 가능한 단위로 작업을 쪼개는 게 핵심.

## 출처

- [Ralph Loop GitHub](https://github.com/anthropics/ralph-loop)
  → 실제 저장소는 `@pageai/ralph-loop`
- [Anthropic 장시간 에이전트 연구](https://www.anthropic.com)
  → 작업 포맷의 연구적 근거
