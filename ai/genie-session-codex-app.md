# Genie Session: Codex App

Kent Beck의 Genie Session — Codex for Mac으로
GPUSortedMap을 구현하는 라이브 코딩 세션 분석.

영상: <https://www.youtube.com/watch?v=PVMOCU2zjZg>

## 기술적 리더십의 재정의

AI와 지니(Genie) 시스템이 도입된 지금,
**아무도 확정적인 정답을 알지 못하는 시대**가 되었다.

과거의 숙련된 프로그래머는 정답을 제시하는 역할이었지만,
현대의 기술 리더는 팀원들이 **스스로 답을 찾아가는
과정을 가이드하고 함께 실험하는 능력**을 갖추어야 한다.

Kent Beck 자신도 젊은 세대가 도구 활용에
더 능숙할 수 있음을 인정하며,
자신의 고정관념이나 편향이 오히려
방해가 될 수 있음을 경계한다.

> 정답을 아는 것이 아니라,
> 새로운 도구를 직접 사용해 보며
> 한계와 가능성을 탐색하는 실천적 자세가 중요하다.

## GPUSortedMap

키가 항상 정렬된 상태를 유지하는 데이터 구조로,
데이터베이스의 백엔드 저장소로 활용되는 핵심 메커니즘.

4가지 기본 연산:

- **Get** — 키 가져오기
- **Put** — 넣기
- **Delete** — 삭제
- **Iterate** — 특정 범위의 키 순회 (가장 중요)

### GPU 특성에 맞는 설계

GPU 환경에서는 포인터를 따라가는 작업이
비용이 매우 크다.
전통적인 트리 구조 대신
**모든 키를 연속된 버퍼에 정렬된 상태로 유지**한다.
GPU에서 정렬 연산은 상대적으로 저렴하고,
대량의 데이터를 병렬로 처리하는 데 유리하기 때문이다.

### 톰스톤(Tombstone) 구조

삭제된 데이터를 관리하는 압축 구조.
Put 과정에서 정렬을 다시 수행할 때
톰스톤 항목들을 **동시에 압축하여 제거**하는
최적화를 적용한다.

- 메모리 공간의 효율적 활용
- 데이터 구조의 무결성 유지
- 불필요한 데이터 누적에 의한 성능 저하 방지

### GPU 멀티 겟(Multi-get)

수천 개의 스레드가 동시에 작업하는
"스레드의 전당(Hall of Threads)".

- 키는 결합된 읽기(Coalesced reads)가 가능하도록
  GPU 버퍼 내에 정렬 배치
- 값들은 디바이스 메모리 내 인접하게 저장하여
  접근 속도를 높임

## Kent Beck이 강조하는 것들

### 1. TDD를 고수하라

AI 도구를 사용해도 **테스트 코드가 최우선**이다.
코드 구현 전에 회귀 테스트를 먼저 작성하도록
지니에게 지시한다.

왜 엄격하게 고수하는가:

- 지니가 **테스트를 삭제**하는 경우가 있다
- 검증 문구를 무시하고 **모든 것이 정상이라고
  거짓 보고**하는 경우가 있다
- 테스트는 지니의 불확실성을 제어하고,
  생성된 코드가 의도대로 동작하는지 검증하는
  **가장 확실한 수단**이다

사람이 직접 코딩할 때는 테스트를 하나씩 작성하지만,
지니와 같은 강력한 도구를 사용할 때는
**여러 테스트를 동시에 작성하고 실행**하는 방식이
더 효율적일 수 있다.

### 2. 엔지니어링 호기심

"GPU가 빠르다"는 직관에 의존하지 않는다.
실제 오버헤드를 **구체적인 숫자로 파악**한다.

측정 결과:

- 소규모 연산에서 GPU는 CPU 기반 B-tree 맵보다
  약 **700~800배** 더 많은 오버헤드 발생
- 원인: GPU 연산 호출 시 발생하는
  핸드셰이크(Handshake) 비용
- 결론: GPU는 단일 연산보다
  **대량 벌크 연산에 적합**

> 내면의 비판적인 목소리 대신
> "이것은 얼마나 더 비용이 드는가?"와 같은
> 근본적인 질문을 던지는 것이
> 기술 발전을 위한 핵심 동력이다.

### 3. 지니를 인내심 있는 튜터로 활용

성능 테스트 개선 과정에서 지니가
**바이젝티브 아핀 변환(Bijective Affine Transform)**
이라는 복잡한 수학적 개념을 도입하여
중복 없는 랜덤 키 생성을 구현했다.

Kent Beck은 이를 고등학생도 이해할 수 있을 정도의
쉬운 비유로 설명해 달라고 요청한다.

- 아핀 변환 = 단순히 곱하고 더하는 규칙
- 바이젝티브(전단사) = 모든 입력이 중복 없이
  정확히 하나의 출력으로 연결되는 완벽한 셔플

이런 지식 습득 과정을 **선택 가능성(Futures)을
높이는 수직적 도약**으로 정의한다.
눈앞의 기능(Features) 구현만큼이나
시스템을 이해하고 확장할 수 있는 능력을
키우는 것이 중요하다.

### 4. IDE의 미래

Codex for Mac이 전통적인 IDE를 흉내 내지 않는 점을
긍정적으로 평가한다.

지니가 코드의 위치를 스스로 찾고 조작할 수 있다면,
인간이 관리하기 편하도록 파일을 폴더별로
정교하게 분류하던 **전통적인 구조는
더 이상 필요하지 않을 수도 있다**.

과거 스몰토크(Smalltalk) 환경에서의 경험을 바탕으로,
소스 코드가 반드시 파일 시스템의 물리적 경로에
종속될 필요가 없다는 관점을 제시한다.

> 복잡한 폴더 구조를 탐색하는 데
> 시간을 낭비하는 대신,
> 지니가 코드를 더 쉽게 이해하고 조작할 수 있도록
> 시스템을 단순화하는 데 집중해야 한다.

## 인사이트

### Features vs Futures

Kent Beck은 당장의 기능(Features)과
미래의 선택 가능성(Futures)을 구분한다.

지니와 협업하며 복잡한 개념을 학습하는 과정은
단순한 기능 구현이 아니라 Futures를 높이는 행위다.
시스템을 이해하고 확장할 수 있는 능력은
향후 더 복잡한 기능을 구현할 때
유연하게 대처할 수 있는 기반이 된다.

### 두려움을 에너지로

> 변화하는 세상을 두려워하기보다
> 그 두려움을 에너지로 삼아
> 호기심을 발휘하고 끊임없이 실험하라.

AI를 활용한 소프트웨어 개발은
이제 막 시작된 단계이며,
누구나 이 분야의 선구자가 될 수 있는
기회가 열려 있다.

### 도구와 공생하는 자세

이번 세션의 실질적 성과:

- 톰스톤 구조의 압축 최적화
- 회귀 테스트 구축
- 벤치마크 성능 기록

단순한 기능 구현을 넘어
**시스템 구조를 단순화하고
도구와 공생하는 미래 지향적 개발 자세**를 강조한다.

## 관련 문서

- [Genie Sessions: GPU Sorted Map](./genie-sessions-gpu-sorted-map.md)
- [Vibe Coding](./vibe-coding.md) - Augmented Coding
- [Codex](./codex.md) - OpenAI Codex
- [Kent Beck](../agile/kent-beck.md)
