# Cosmologically Unique ID

<https://jasonfantl.com/posts/Universal-Unique-IDs/>

<https://news.hada.io/topic?id=26821>

UUID는 지구에서 쓰기엔 충분하다.
그런데 인류가 은하 너머로 퍼져나간다면?
중앙 권한 없이, 우주 어디서든 충돌 없는 ID를
만들려면 몇 비트가 필요할까?

## 핵심 아이디어

가장 단순한 방법은 매번 랜덤 숫자를 뽑는 것이다.
중앙 서버도, 조율도 필요 없다.
문제는 두 기기가 같은 숫자를 뽑을 수 있다는 점인데,
숫자 범위를 충분히 크게 잡으면
충돌 확률을 "사실상 0"으로 만들 수 있다.

## 얼마나 커야 하는가

"Universal Limits on Computation" 논문에 따르면,
우주 전체를 최대 효율 컴퓨터(Computronium)로
바꿔도 열 죽음(Heat Death)까지
약 10^120번의 연산만 가능하다.

모든 연산이 새 ID를 생성한다고 가정하면:

| 시나리오                         | 필요 비트 |
|----------------------------------|-----------|
| 우주 전체 연산 (10^120)          | ~798      |
| 관측 가능한 우주의 원자 (10^80)  | ~532      |
| 현행 UUID v4                     | 122       |

생일 역설(Birthday Paradox)로 계산하면,
10^120개의 ID 공간에서 충돌을 피하려면
log₂(10^240) ≈ 798비트가 필요하다.
좀 더 현실적으로, 관측 가능한 우주의 모든
원자(10^80개)에 ID를 부여하는 경우 532비트면 된다.

## 확률적 사고

운석에 맞을 확률은 0이 아니다.
하지만 지구상 모든 사람이 지금 이 순간
동시에 운석에 맞을 확률은?
0은 아니지만 사실상 불가능하다.

ID 충돌 확률을 바로 그 수준으로 낮출 수 있다.
결정론적(Deterministic) 방식보다
충분히 큰 랜덤 숫자가 훨씬 실용적이다.

## 인사이트

- **UUID 122비트는 지구 규모에서 이미 과잉이다.**
  2^61개 ≈ 약 23경 개의 ID를 만들어야 충돌이
  기대되는 수준이니, 대부분의 시스템에서는
  걱정할 필요가 없다.
- **우주 스케일에서도 랜덤이 답이다.**
  중앙 서버 기반 순차 할당은 빛의 속도 제약으로
  은하 간 통신에서 쓸 수 없다.
  결국 랜덤 + 충분한 비트 수가
  가장 범용적이고 확장 가능한 해법이다.
- **비트 수를 늘리는 비용은 사실상 무시할 수 있다.**
  798비트 = 100바이트. 저장 공간이나
  네트워크 대역폭 관점에서 거의 비용이 없다.
  충돌 없는 ID의 가치에 비하면 아무것도 아니다.
- **물리학이 상한선을 정해준다.**
  Computronium 모델은 "이보다 더 많은 ID는
  물리적으로 생성 불가능"이라는 절대적 한계를
  제공한다. 엔지니어링의 "충분히 큰 숫자"를
  물리학이 증명해 주는 셈이다.
- **분산 시스템 설계의 본질과 맞닿아 있다.**
  조율(Coordination) 없이 고유성을 보장하는 것은
  분산 시스템의 근본 문제다.
  UUID가 답이 된 이유는 "충분히 큰 랜덤"이
  합의(Consensus) 프로토콜 없이도
  고유성을 달성하기 때문이다.

## 참고

- [UUID](./uuid.md)
- [ULID](./ulid.md)
- [TSID](./tsid.md)
