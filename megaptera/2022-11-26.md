# 2022-11-26

## <https://justdoit7938.tistory.com/175>

“로그인을 하고 ACCESSTOEKN을 APIService 모듈에 set을 해줘야 하는데
set을 해줘야 하는 파일이 5개가 넘게 있었다.”

정확히 어떤 상황인지는 모르겠지만, 이 부분은 그 자체로 문제가 큽니다.
게다가 이에 대한 해법도 상속이 아니에요.
추상-구상 관계가 아닌데 상속을 하고 있다면 상속을 잘못 쓰고 있다는 강력한 신호죠.
인터페이스 상속(다형성)이 아니라 구현 상속을 하는 건 대부분 임시방편입니다.
리팩터링 대상이죠.

얼핏 보이는 `changePageNumber`란 이름도 부적절합니다.
일단 change가 아니죠.
더 큰 건 저는 이게 뭔지 모르겠습니다.
product element를 얻는데 pagination을 할 수는 없거든요.
만약 특정 상품에 대한 문의사항 목록을 얻는다면
`GET /products/{productId}/inquiries`가 될 거고,
`fetchInquiries({ productId, page = 1 })`
하나로 커버가 돼야 합니다.
아마 `class ApiService`가 아닌 것 같은데,
지금 규모에 맞지 않게 불필요한 메서드가 많을 가능성이 큽니다.
처음에는 하나로 하다가 커졌을 때
“어떻게 분리하는 게 올바를까?”를 고민하는 게 좋습니다.

코드를 다시 보니 혹시 store를 상속해서 하시는 건가요?
그렇다면 더욱 위임을 사용하세요.
`const productStore = new ProductStore({ sessionStore });`
같은 걸 고려해 보세요.
스프링은 DI를 알아서 해주지만, 여기선 직접 해줘야 합니다.

아래 코드를 보니 `APIService`를 상속하시는 것 같네요.
이런 거라면 처음에 적은 코멘트처럼 설계를 개선하셔야 합니다.

이런 경우라면 `setAccessToken`이란 코드를 5곳에 적어야 한다는 걸 문제로 보신 것 같은데,
`setAccessToken`을 5번 호출하는 게 더 큰 문제입니다.
어떤 걸 큰 문제로 보느냐에 따라 방향이 크게 갈리게 됩니다.

그나저나 `accessToken`을 파라미터로 받는데 필드로 있는 건 어떤 건지 모르겠네요.
이게 코드를 봤을 때 헷갈린 요인인데,
혹시 파라미터로 받는 걸 필드로 옮기는 작업을 하신 건가요?
그렇다면 상속하지 않게 하세요.
객체지향적인 접근을 하면 대부분 상속이 아니라 협력=위임을 하게 됩니다.
백엔드 개발할 때 JWT 관련 코드를 이곳 저곳에서 쓴다고 해서
뭔가를 상속하거나 하지 않았다는 걸 떠올려 보세요.
동일한 인터페이스지만 구현이 다른 경우
= 다형성이 필요한 경우에만 상속이 쓰인다는 원칙을 지키면 됩니다.

참고로, API가 꽤 많다면 Axios 인스턴스도 도입하세요. 코드 정리하기 아주 좋습니다.

<https://axios-http.com/docs/instance>

강의에서는 `baseUrl` 잡는 용도로 썼을텐데,
`headers`(특히 `Authorization`!)도 같이 잡아주면 좋습니다.
